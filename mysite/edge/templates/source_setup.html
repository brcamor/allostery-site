{% extends 'base.html' %}

{% block header_text %} Protein Set-up: {{ pdb_id }} {% endblock %}

{% block header_sub_text %}
Select the residues you would like to use as the source in the analysis 
{% endblock %}

{% block protein_view %}

<div id="jmol_protein_view" align="center">
<script type="text/javascript">
  var Info = {
  width: 800,
  height: 500,
    use: "WebGL HTML5",
  j2sPath: "static/jsmol/j2s",
  console: "jmolApplet0_infodiv"
  }
  jmolApplet0 = Jmol.getApplet("jmolApplet0", Info);
  Jmol.script(jmolApplet0,'background black;load {{ MEDIA_URL }}{{ pdb_id }}.pdb ;select all;cartoon only; color lightgrey; set hermiteLevel 5; select hetero and not solvent; wireframe on;wireframe 50;')

function showResidueSticks(chkbox, resNum, chainID){
if (chkbox.checked) {
Jmol.script (jmolApplet0,'select ' + resNum + ':' + chainID + '; wireframe on; wireframe 50; color red;');
}
else {
Jmol.script (jmolApplet0,'select ' + resNum + ':' + chainID + '; wireframe off; color lightgrey;');
}
}
</script>

{% endblock %}

{% block table %}

<form role="form" method="POST" action="">

  <table class="table" id="id_source_table">
    <thead>
      <tr>
	<th>Residue number</th>
	<th>Chain</th>
	<th>Selected</th>
      </tr>
    </thead>

    <tbody>
      {% for residue in residues %}
      <tr>
	<td>{{ residue.0 }}</td>
	<td>{{ residue.1 }}</td>
	<td><input type="checkbox" 
		   id="residue_checkbox_{{forloop.counter}}" 
		   name="residues" 
		   value="{{forloop.counter | add:"-1" }}"
		   onclick="showResidueSticks(this, '{{ residue.0 }}','{{ residue.1 }}')"></td>
      </tr>
    {% endfor %}
    </tbody>
  </table>

  {% csrf_token %}
  <input type="submit" class="btn btn-large btn-primary" id="continue_button" value="Continue">

</form>
  
{% endblock %}
